(this.webpackJsonpfrontend=this.webpackJsonpfrontend||[]).push([[0],{61:function(e,t,n){},62:function(e,t,n){"use strict";n.r(t);var r=n(0),a=n(1),s=n(27),c=n.n(s),o=n(10),i=n.n(o),u=n(13),l=n(7),j=n(9),b=n(2),p=n(11),d=n.n(p),h=Object(a.createContext)(null);function O(){var e=Object(a.useContext)(h),t=e.userData,n=e.setUserData,s=Object(b.f)();return Object(r.jsx)("nav",{className:"auth-options",children:t.user?Object(r.jsx)(r.Fragment,{children:Object(r.jsx)("button",{onClick:function(){n({token:void 0,user:void 0}),localStorage.setItem("auth-token","")},children:"Log out"})}):Object(r.jsxs)(r.Fragment,{children:[Object(r.jsx)("button",{onClick:function(){return s.push("/register")},children:"Register"}),Object(r.jsx)("button",{onClick:function(){return s.push("/login")},children:"Login"})]})})}function g(){return Object(r.jsxs)("header",{id:"header",children:[Object(r.jsx)(j.b,{to:"/",children:Object(r.jsx)("h1",{className:"title",children:"App Auth"})}),Object(r.jsx)(O,{})]})}function m(){var e=Object(a.useContext)(h).userData,t=Object(b.f)();return Object(a.useEffect)((function(){e.user||t.push("/login")})),Object(r.jsx)("div",{className:"page",children:e.user?Object(r.jsx)(r.Fragment,{children:Object(r.jsxs)("h1",{className:"welcome",children:["Welcome ",e.user.displayName]})}):Object(r.jsxs)(r.Fragment,{children:[Object(r.jsx)("h2",{children:"You are not logged in"}),Object(r.jsx)(j.b,{to:"/login",children:"Log in"})]})})}function x(e){return Object(r.jsxs)("div",{className:"error-notice",children:[Object(r.jsx)("span",{children:e.message}),Object(r.jsx)("button",{onClick:e.clearError,children:"X"})]})}function f(){var e=Object(a.useState)(),t=Object(l.a)(e,2),n=t[0],s=t[1],c=Object(a.useState)(),o=Object(l.a)(c,2),j=o[0],p=o[1],O=Object(a.useState)(),g=Object(l.a)(O,2),m=g[0],f=g[1],v=Object(a.useContext)(h).setUserData,k=Object(b.f)(),w=function(){var e=Object(u.a)(i.a.mark((function e(t){var r,a;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),e.prev=1,r={email:n,password:j},e.next=5,d.a.post("https://login-sign.herokuapp.com/login",r);case 5:a=e.sent,v({token:a.data.token,user:a.data.user}),localStorage.setItem("auth-token",a.data.token),k.push("/"),e.next=14;break;case 11:e.prev=11,e.t0=e.catch(1),e.t0.response.data.msg&&f(e.t0.response.data.msg);case 14:case"end":return e.stop()}}),e,null,[[1,11]])})));return function(t){return e.apply(this,arguments)}}();return Object(r.jsxs)("div",{className:"page",children:[Object(r.jsx)("h1",{children:"Login"}),m&&Object(r.jsx)(x,{message:m,clearError:function(){return f(void 0)}}),Object(r.jsxs)("form",{className:"form",onSubmit:w,children:[Object(r.jsx)("label",{htmlFor:"login-email",children:"Email"}),Object(r.jsx)("input",{id:"login-email",type:"email",onChange:function(e){return s(e.target.value)}}),Object(r.jsx)("label",{htmlFor:"login-password",children:"Password"}),Object(r.jsx)("input",{id:"login-password",type:"password",onChange:function(e){return p(e.target.value)}}),Object(r.jsx)("input",{type:"submit",value:"Log in"})]})]})}function v(){var e=Object(a.useState)(),t=Object(l.a)(e,2),n=t[0],s=t[1],c=Object(a.useState)(),o=Object(l.a)(c,2),j=o[0],p=o[1],O=Object(a.useState)(),g=Object(l.a)(O,2),m=g[0],f=g[1],v=Object(a.useState)(),k=Object(l.a)(v,2),w=k[0],C=k[1],y=Object(a.useState)(),S=Object(l.a)(y,2),F=S[0],N=S[1],D=Object(a.useContext)(h).setUserData,E=Object(b.f)(),I=function(){var e=Object(u.a)(i.a.mark((function e(t){var r,a;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),e.prev=1,r={email:n,password:j,passwordCheck:m,displayName:w},e.next=5,d.a.post("https://login-sign.herokuapp.com/users/register",r);case 5:return e.next=7,d.a.post("https://login-sign.herokuapp.com/users/login",{email:n,password:j});case 7:a=e.sent,D({token:a.data.token,user:a.data.user}),localStorage.setItem("auth-token",a.data.token),E.push("/"),e.next=16;break;case 13:e.prev=13,e.t0=e.catch(1),e.t0.response.data.msg&&N(e.t0.response.data.msg);case 16:case"end":return e.stop()}}),e,null,[[1,13]])})));return function(t){return e.apply(this,arguments)}}();return Object(r.jsxs)("div",{className:"page",children:[Object(r.jsx)("h1",{children:"Register"}),F&&Object(r.jsx)(x,{message:F,clearError:function(){return N(void 0)}}),Object(r.jsxs)("form",{className:"form",onSubmit:I,children:[Object(r.jsx)("label",{htmlFor:"register-email",children:"Email"}),Object(r.jsx)("input",{id:"register-email",type:"email",onChange:function(e){return s(e.target.value)}}),Object(r.jsx)("label",{htmlFor:"register-password",children:"Password"}),Object(r.jsx)("input",{id:"register-password",type:"password",onChange:function(e){return p(e.target.value)}}),Object(r.jsx)("input",{type:"password",placeholder:"Verify password",onChange:function(e){return f(e.target.value)}}),Object(r.jsx)("label",{htmlFor:"register-display-name",children:"Display name"}),Object(r.jsx)("input",{id:"register-display-name",type:"text",onChange:function(e){return C(e.target.value)}}),Object(r.jsx)("input",{type:"submit",value:"Register"})]})]})}function k(){var e=Object(a.useState)({token:void 0,user:void 0}),t=Object(l.a)(e,2),n=t[0],s=t[1];return Object(a.useEffect)((function(){(function(){var e=Object(u.a)(i.a.mark((function e(){var t,n;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return null===(t=localStorage.getItem("auth-token"))&&(localStorage.setItem("auth-token",""),t=""),e.next=4,d.a.post("https://login-sign.herokuapp.com/users/tokenIsValid",null,{headers:{"x-auth-token":t}});case 4:if(!e.sent.data){e.next=10;break}return e.next=8,d.a.get("https://login-sign.herokuapp.com/users/",{headers:{"x-auth-token":t}});case 8:n=e.sent,s({token:t,user:n.data});case 10:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}})()()}),[]),Object(r.jsx)(r.Fragment,{children:Object(r.jsx)(j.a,{children:Object(r.jsxs)(h.Provider,{value:{userData:n,setUserData:s},children:[Object(r.jsx)(g,{}),Object(r.jsx)("div",{className:"container",children:Object(r.jsxs)(b.c,{children:[Object(r.jsx)(b.a,{exact:!0,path:"/",component:m}),Object(r.jsx)(b.a,{path:"/login",component:f}),Object(r.jsx)(b.a,{path:"/register",component:v})]})})]})})})}n(61);var w=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,63)).then((function(t){var n=t.getCLS,r=t.getFID,a=t.getFCP,s=t.getLCP,c=t.getTTFB;n(e),r(e),a(e),s(e),c(e)}))};c.a.render(Object(r.jsx)(k,{}),document.getElementById("root")),w()}},[[62,1,2]]]);
//# sourceMappingURL=main.d3d73cef.chunk.js.map